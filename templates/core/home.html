{% extends "base.html" %}
{% block title %}Welcome • Expensely{% endblock %}

{% block header %}
  {% if guest %}
    <h1 class="page-title">Welcome to Expensely</h1>
    <p class="text-body-secondary mb-0">Track income & expenses with a clean Django app.</p>
  {% else %}
    <h1 class="page-title">Welcome back</h1>
    <p class="text-body-secondary mb-0">Here’s a quick snapshot of your month.</p>
  {% endif %}
{% endblock %}

{% block content %}
{% if guest %}
  <div class="card card-soft p-4 d-flex flex-md-row align-items-center justify-content-between">
    <div class="pe-md-4">
      <h2 class="h5 mb-2">Get started</h2>
      <p class="mb-3">Create an account and we’ll set up your categories and transactions next.</p>
      <div class="d-flex gap-2">
        <a class="btn btn-warning btn-pill" href="{% url 'signup' %}"><i class="bi bi-person-plus"></i> Sign up</a>
        <a class="btn btn-outline-secondary btn-pill" href="{% url 'login' %}"><i class="bi bi-box-arrow-in-right"></i> Log in</a>
      </div>
    </div>
    <i class="bi bi-pie-chart" style="font-size:3rem;"></i>
  </div>
{% else %}
  <div class="row g-3">
    <div class="col-md-4">
      <div class="card card-soft p-3">
        <h2 class="h6 text-uppercase text-body-secondary mb-2">This Month</h2>
        <div class="d-flex justify-content-between"><span>Income</span><strong>{{ month_income }}</strong></div>
        <div class="d-flex justify-content-between"><span>Expense</span><strong>{{ month_expense }}</strong></div>
        <hr class="my-2">
        <div class="d-flex justify-content-between"><span>Balance</span>
          <strong class="{% if month_balance < 0 %}text-danger{% endif %}">{{ month_balance }}</strong>
        </div>
        <div class="mt-3 d-grid">
          <a class="btn btn-warning btn-sm" href="{% url 'transaction_create' %}"><i class="bi bi-plus"></i> New Transaction</a>
        </div>
      </div>
    </div>

    <div class="col-md-8">
      <div class="card card-soft p-0">
        <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
          <strong>Recent transactions</strong>
          <a class="btn btn-outline-secondary btn-sm" href="{% url 'transaction_list' %}">View all</a>
        </div>
        <table class="table mb-0 align-middle">
          <thead><tr><th>Date</th><th>Category</th><th>Note</th><th class="text-end">Amount</th></tr></thead>
          <tbody>
            {% for t in recent %}
            <tr>
              <td>{{ t.date }}</td>
              <td>{{ t.category.name }} <span class="badge bg-light text-dark text-capitalize">{{ t.category.type }}</span></td>
              <td>{{ t.note|default:"—" }}</td>
              <td class="text-end">{{ t.amount }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="4" class="text-center text-body-secondary py-4">No transactions yet.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
{% endif %}
{% endblock %}
